# Plan - 开发任务执行计划

## 命令用途

根据 PRD 执行开发任务，确保开发遵循项目规范，代码与文档保持一致。

**核心原则：**

- **先测试后开发**：开发前先编写测试用例，明确验收标准
- **边开发边验证**：核心逻辑即时测试，快速反馈
- **文档同步**：开发完成后更新相关文档

## 使用方式

```
/plan-dev <PRD文档路径>
```

---

## 执行流程

### 第一步：理解 PRD

阅读 PRD，提取关键信息：

- 功能需求、技术需求、API/UI 规范
- 目标、成功标准、验收检查清单
- 依赖关系和模块交互点

### 第二步：分析项目上下文

了解现有实现：

- 相关代码的设计模式和实现方式
- 可复用的组件、工具函数、类型定义
- 需要修改的模块和文件
- 相关测试文件和规范

### 第三步：编写测试用例

**开发前**编写测试用例文档（`docs/test-cases/{功能名称}-test-cases.md`）：

- 功能测试（正常流程）
- 边界条件测试
- 错误处理测试
- 集成测试（如适用）

### 第四步：制定开发计划

拆分可执行任务：

- 明确任务的输入、输出、依赖关系
- 确定开发顺序（先依赖项，后依赖方）
- 列出需要创建/修改的文件清单

```markdown
## 开发任务清单

### 后端

- [ ] 任务 1：实现 XXX API
- [ ] 任务 2：更新服务层逻辑

### 前端

- [ ] 任务 1：创建 XXX 组件
- [ ] 任务 2：实现 XXX Hook
```

### 第五步：执行开发（带即时验证）

按模块开发，核心逻辑即时测试：

**执行节奏：**

- 每完成一个功能模块，立即运行该模块的测试
- 发现问题立即修复，再继续下一模块

**即时测试范围：**

| 类型           | 策略              |
| -------------- | ----------------- |
| 核心业务逻辑   | ✅ 即时测试       |
| 工具函数/Hooks | ✅ 即时测试       |
| API 端点       | ✅ 即时测试       |
| UI 组件        | ⏳ 可延迟批量测试 |

> 开发规范参考 `.cursor/rules/development-specifications.mdc`

### 第六步：集成验收

完成开发后进行最终验证：

- 运行完整测试套件
- 端到端集成测试
- 逐项确认 PRD 验收检查清单
- 检查模块间交互正确性

### 第七步：同步文档

更新相关文档，确保与实现一致：

- **技术文档**：API 文档、架构文档、数据库文档
- **设计文档**：UI/UX 说明、流程图
- **README**：功能列表、环境变量、部署说明
- **测试文档**：执行结果、已知问题

### 第八步：输出总结

```markdown
## 开发总结

### 完成情况

- 已完成功能点
- 未完成部分及原因

### 测试结果

- 测试通过率
- 覆盖率情况

### 文档更新

- 已更新的文档清单

### 后续工作

- 待优化项
- 技术债务
```

---

## 质量检查清单

### PRD 覆盖度

- [ ] 所有功能需求已实现
- [ ] 所有验收标准已达成

### 代码规范

- [ ] 命名约定正确
- [ ] 类型定义完整
- [ ] 代码结构符合架构模式

### 测试覆盖

- [ ] 测试用例文档已编写
- [ ] 单元测试全部通过
- [ ] 集成测试全部通过

### 文档同步

- [ ] 所有文档内容与实现一致

---

## 注意事项

1. **严格遵守顺序**：先测试用例 → 边开发边验证 → 集成验收 → 同步文档
2. **规范优先**：不确定时参考 `.cursor/rules/`
3. **核心逻辑即时测试**：不要等到最后才发现基础模块有问题
4. **文档同步必须完成**：不能跳过
