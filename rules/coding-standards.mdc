---
description: Coding Standards
alwaysApply: true
---

# å¼€å‘è§„èŒƒä¸ç¼–ç æ ‡å‡†

## ğŸ† æ ¸å¿ƒåŸåˆ™

### 1. çº¦å®šå¤§äºé…ç½® (Convention over Configuration)

ä¼˜å…ˆä½¿ç”¨æ¡†æ¶å’Œåº“çš„é»˜è®¤çº¦å®šï¼Œé¿å…è¿‡åº¦è‡ªå®šä¹‰é…ç½®ã€‚

**æ¶æ„è®¾è®¡æœ€å°é…ç½®åŸåˆ™**ï¼š

- ç†æƒ³çŠ¶æ€ä¸‹å¼€å‘è€…æ— éœ€ä¼ å…¥ä»»ä½•é…ç½®å³å¯è¿è¡Œåœ¨"æœ€ä½³é…ç½®"
- åªæš´éœ²ç¡®å®å¿…è¦çš„é…ç½®é€‰é¡¹ï¼Œéšè—æŠ€æœ¯å®ç°ç»†èŠ‚
- æä¾›åˆç†çš„é»˜è®¤å€¼ï¼Œè®© 80% çš„ä½¿ç”¨åœºæ™¯å¼€ç®±å³ç”¨
- é…ç½®é¡¹åº”è¯¥æ˜¯ä¸šåŠ¡éœ€æ±‚é©±åŠ¨ï¼Œè€ŒéæŠ€æœ¯å®ç°é©±åŠ¨

```typescript
// âŒ BAD: è¿‡åº¦é…ç½®
function createApiClient(config: {
  baseUrl?: string;
  timeout?: number;
  retries?: number;
  headers?: Record<string, string>;
  interceptors?: Array<Function>;
  // ... 20+ é…ç½®é¡¹
}) {}

// âœ… GOOD: æœ€å°é…ç½®ï¼Œåˆç†é»˜è®¤å€¼
function createApiClient(baseUrl: string, options?: { timeout?: number }) {
  return {
    baseUrl,
    timeout: options?.timeout ?? 5000,
    // å…¶ä»–é…ç½®ä½¿ç”¨æ¡†æ¶é»˜è®¤å€¼
  };
}
```

### 2. ä¿æŒä»£ç ç²¾ç®€ (Keep It Simple)

- **æ‹’ç»è¿‡åº¦è®¾è®¡**ï¼šä¸è¦ä¸ºäº†"æœªæ¥å¯èƒ½çš„éœ€æ±‚"è€Œæ·»åŠ å¤æ‚æŠ½è±¡
- **å•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªå‡½æ•°ã€ç»„ä»¶åªåšä¸€ä»¶äº‹
- **åˆ é™¤æ­»ä»£ç **ï¼šåŠæ—¶æ¸…ç†ä¸ç”¨çš„ä»£ç ã€æ³¨é‡Šå’Œä¾èµ–
- **é¿å…æ·±å±‚åµŒå¥—**ï¼šè¶…è¿‡ 3 å±‚åµŒå¥—æ—¶è€ƒè™‘é‡æ„

```typescript
// âŒ BAD: è¿‡åº¦æŠ½è±¡
class AbstractDataProcessorFactory {
  createProcessor(type: string): Processor {
    return new ProcessorBuilder()
      .withStrategy(this.getStrategy(type))
      .withValidator(this.getValidator(type))
      .build();
  }
}

// âœ… GOOD: ç®€å•ç›´æ¥
function processData(data: unknown, type: string): ProcessedData {
  if (type === "user") return processUserData(data);
  if (type === "order") return processOrderData(data);
  throw new Error(`Unknown type: ${type}`);
}
```

### 3. ç±»å‹å®‰å…¨ä¼˜å…ˆ (Type Safety First)

- **é¿å… `any` ç±»å‹**ï¼šä½¿ç”¨å…·ä½“ç±»å‹æˆ– `unknown`
- **é¿å…ç±»å‹æ–­è¨€**ï¼šä¼˜å…ˆä½¿ç”¨ç±»å‹å®ˆå«å’Œç±»å‹æ¨å¯¼
- **åˆ©ç”¨ç±»å‹æ¨å¯¼**ï¼šè®© TypeScript è‡ªåŠ¨æ¨å¯¼ç±»å‹ï¼Œå‡å°‘å†—ä½™æ ‡æ³¨

```typescript
// âŒ BAD
function parseData(data: any): any {
  return JSON.parse(data);
}

// âœ… GOOD
function parseData<T>(data: string): T {
  return JSON.parse(data) as T;
}

// âœ… BETTER: ä½¿ç”¨ç±»å‹å®ˆå«
function isUserData(data: unknown): data is UserData {
  return (
    typeof data === "object" && data !== null && "id" in data && "name" in data
  );
}
```

### 4. å°½æ—©æŠ¥é”™é€€å‡º (Fail Fast Principle)

- **å‚æ•°æ ¡éªŒåœ¨å‡½æ•°å¼€å¤´**ï¼šä¸ç¬¦åˆé¢„æœŸç«‹å³æŠ›å‡ºé”™è¯¯
- **é¿å…å…œåº•é€»è¾‘**ï¼šä¸è¦é»˜é»˜å¤„ç†é”™è¯¯æƒ…å†µ
- **æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯**ï¼šé”™è¯¯è¦è¯´æ˜åŸå› å’Œè§£å†³æ–¹æ¡ˆ

```typescript
// âŒ BAD: é™é»˜å¤±è´¥
function divide(a: number, b: number): number {
  if (b === 0) return 0; // é™é»˜è¿”å›é”™è¯¯å€¼
  return a / b;
}

// âœ… GOOD: ç«‹å³æŠ¥é”™
function divide(a: number, b: number): number {
  if (b === 0) {
    throw new Error("Division by zero: denominator cannot be 0");
  }
  return a / b;
}
```

### 5. é‡æ„æ—¶ä¿æŒç®€æ´ (Clean Refactoring)

- **åˆ é™¤æ—§ä»£ç **ï¼šé‡æ„æ—¶å®Œå…¨ç§»é™¤è¢«æ›¿æ¢çš„ä»£ç 
- **ä¸åšå…¼å®¹å±‚**ï¼šé¿å…ä¸ºäº†å‘åå…¼å®¹è€Œä¿ç•™æ—§æ¥å£
- **ä¸åšé™çº§é€»è¾‘**ï¼šæ–°åŠŸèƒ½å°±ç”¨æ–°æ–¹å¼ï¼Œä¸è¦æ··åˆæ–°æ—§å®ç°
- **ä¸€æ¬¡æ€§è¿ç§»**ï¼šå®Œæ•´é‡æ„è€Œä¸æ˜¯æ¸è¿›å¼å…¼å®¹

```typescript
// âŒ BAD: ä¿ç•™æ—§ä»£ç å’Œå…¼å®¹å±‚
function oldFormatDate(date: Date): string {
  // æ—§å®ç°
}
function newFormatDate(date: Date): string {
  // æ–°å®ç°
}
function formatDate(date: Date, useOld?: boolean): string {
  return useOld ? oldFormatDate(date) : newFormatDate(date);
}

// âœ… GOOD: å®Œå…¨æ›¿æ¢
function formatDate(date: Date): string {
  // æ–°å®ç°ï¼Œæ—§ä»£ç å·²åˆ é™¤
}
```

### 6. å®Œæ•´å®ç°éœ€æ±‚ (Complete Implementation Required)

**ç¦æ­¢å ä½å®ç°**ï¼š

- ä¸å…è®¸ä½¿ç”¨ `TODO`ã€`FIXME`ã€`XXX` ç­‰æ³¨é‡Šå ä½ç¬¦
- ä¸å…è®¸ä½¿ç”¨å‡æ•°æ®ã€ç¡¬ç¼–ç æˆ–æ¨¡æ‹Ÿå“åº”ä½œä¸ºæœ€ç»ˆå®ç°
- ä¸å…è®¸æ ‡æ³¨"å¾…å®ç°"ã€"åç»­è¡¥å……"ã€"ä¸´æ—¶æ–¹æ¡ˆ"ç­‰å»¶æœŸè¯´æ˜

**å¿…é¡»å®Œæ•´å®ç°**ï¼š

- æ‰€æœ‰éœ€æ±‚ç‚¹å¿…é¡»æä¾›å®Œæ•´ã€å¯ç”¨çš„å®ç°ä»£ç 
- å®ç°å¿…é¡»åŸºäºçœŸå®çš„ä¸šåŠ¡éœ€æ±‚ï¼Œä¸èƒ½åŸºäºå‡è®¾
- ä½¿ç”¨æ­£ç¡®ã€ç›´æ¥çš„æ–¹å¼è§£å†³é—®é¢˜ï¼Œé¿å… hack æ‰‹æ®µ
- å®ç°åçš„ä»£ç åº”è¯¥å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€äºŒæ¬¡å¼€å‘è¡¥å……

```typescript
// âŒ BAD: å ä½å®ç°
function fetchUserData(id: string) {
  // TODO: å®ç°çœŸå® API è°ƒç”¨
  return { id, name: "Mock User" };
}

// âœ… GOOD: å®Œæ•´å®ç°
async function fetchUserData(id: string): Promise<UserData> {
  const response = await fetch(`/api/users/${id}`);
  if (!response.ok) {
    throw new Error(`Failed to fetch user: ${response.statusText}`);
  }
  return response.json();
}
```

### 7. å¤ç”¨ä¼˜å…ˆåŸåˆ™ (Reuse First)

- **å…¨å±€æœç´¢å·²æœ‰å®ç°**ï¼šå¼€å‘å‰å…ˆæœç´¢ç›¸ä¼¼åŠŸèƒ½
- **æ‰©å±•ç°æœ‰å·¥å…·**ï¼šä¼˜å…ˆæ‰©å±•è€Œä¸æ˜¯é‡æ–°åˆ›å»º
- **ç»Ÿä¸€çš„å·¥å…·å‡½æ•°**ï¼šç›¸åŒåŠŸèƒ½ä½¿ç”¨ç›¸åŒçš„å·¥å…·
- **å…±äº«ç±»å‹å®šä¹‰**ï¼šé¿å…é‡å¤å®šä¹‰ç›¸åŒçš„ç±»å‹

```typescript
// âŒ BAD: é‡å¤å®ç°
function formatDate1(date: Date): string {
  return date.toISOString().split("T")[0];
}
function formatDate2(date: Date): string {
  return `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
}

// âœ… GOOD: å¤ç”¨ç»Ÿä¸€å·¥å…·
import { formatDate } from "@/utils/date";
// æ‰€æœ‰åœ°æ–¹ä½¿ç”¨åŒä¸€ä¸ª formatDate å‡½æ•°
```

### 8. åˆç†ç»„ç»‡æ–‡ä»¶ (Reasonable File Organization)

- **æŒ‰åŠŸèƒ½åˆ†ç»„**ï¼šç›¸å…³åŠŸèƒ½æ”¾åœ¨ä¸€èµ·
- **é¿å…è¿‡æ·±åµŒå¥—**ï¼šä¸è¶…è¿‡ 3 å±‚ç›®å½•
- **ä½¿ç”¨ç´¢å¼•æ–‡ä»¶**ï¼šç»Ÿä¸€å¯¼å‡ºæ¨¡å—å†…å®¹
- **ä¿æŒæ–‡ä»¶æ•´æ´**ï¼šæ¯ä¸ªæ–‡ä»¶ä¸è¶…è¿‡ 500 è¡Œ

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”œâ”€â”€ UserProfile.tsx
â”‚   â”‚   â”œâ”€â”€ UserList.tsx
â”‚   â”‚   â””â”€â”€ index.ts          # ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ date.ts
â”‚   â””â”€â”€ format.ts
â””â”€â”€ types/
    â””â”€â”€ user.types.ts
```

### 9. å‘½åçº¦å®š (Naming Conventions)

**æ–‡ä»¶å‘½å**ï¼š

- React ç»„ä»¶ï¼š`PascalCase.tsx`ï¼ˆå¦‚ `UserProfile.tsx`ï¼‰
- Hooksï¼š`use-kebab-case.ts`ï¼ˆå¦‚ `use-auth.ts`ï¼‰
- å·¥å…·å‡½æ•°ï¼š`kebab-case.ts`ï¼ˆå¦‚ `format-date.ts`ï¼‰
- ç±»å‹å®šä¹‰ï¼š`kebab-case.types.ts`

**ä»£ç å‘½å**ï¼š

- ç»„ä»¶/ç±»ï¼š`PascalCase`
- å‡½æ•°/å˜é‡ï¼š`camelCase`
- å¸¸é‡ï¼š`UPPER_SNAKE_CASE`
- Props ç±»å‹ï¼š`{ComponentName}Props`
- äº‹ä»¶å¤„ç†å™¨ï¼š`handle` å‰ç¼€ï¼ˆå¦‚ `handleClick`ï¼‰

```typescript
// âœ… GOOD: ç¬¦åˆå‘½åçº¦å®š
const MAX_RETRY_COUNT = 3;

interface UserProfileProps {
  userId: string;
  onUpdate?: (user: User) => void;
}

function UserProfile({ userId, onUpdate }: UserProfileProps) {
  const handleClick = () => {
    // ...
  };
}
```

---

> **è®°ä½**ï¼šç®€å•ã€ç›´æ¥ã€å®‰å…¨ã€‚è¿™ä¸‰ä¸ªè¯æ¦‚æ‹¬äº†æˆ‘ä»¬æ‰€æœ‰çš„å¼€å‘åŸåˆ™ã€‚
